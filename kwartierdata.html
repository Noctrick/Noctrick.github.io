<!-- in <head> or before </body> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  EAN: <input id="ean" placeholder="871687120057248244"><br>
  Start: <input id="start" type="datetime-local"><br>
  End:   <input id="end"   type="datetime-local"><br>
  Type: 
    <select id="type">
      <option>Elektriciteit</option>
      <option>Gas</option>
    </select><br>
  Direction:
    <select id="direction">
      <option>Levering</option>
      <option>Teruglevering</option>
    </select><br>
  <button id="download">Download Excel</button>
  
  <script>
  document.getElementById('download').onclick = async () => {
    const ean       = document.getElementById('ean').value;
    const startISO  = new Date(document.getElementById('start').value).toISOString();
    const endISO    = new Date(document.getElementById('end').value).toISOString();
    const type      = document.getElementById('type').value;
    const direction = document.getElementById('direction').value;
  
    const qs = new URLSearchParams({ ean, start: startISO, end: endISO, type, direction });
    const res = await fetch(`/.netlify/functions/getReadings?${qs}`);
    if (!res.ok) {
      const txt = await res.text();
      return alert(`Error ${res.status}: ${txt}`);
    }
    const data = await res.json(); // [{datetime,value},...]
  
    // turn into sheet & download
    const ws = XLSX.utils.json_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'Readings');
    XLSX.writeFile(wb, `readings_${ean}.xlsx`);
  };
  </script>
  